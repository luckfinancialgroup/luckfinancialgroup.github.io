<!DOCTYPE html>

<html>

<head>

<meta http-equiv="X-UA-Compatible" content="IE=edge"> 

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>

</head>

<style>
body {
	letter-spacing: 2px;
}
input {
	color: #000000;
	padding: 5px;
}
h1 {
	font-size: 28px;
}
h2 {
	font-size: 20px;
}
table {
	margin-top: 10px;
	margin-bottom: 10px;
	border: 1px solid #14446c;
}
table * {
	text-align: center;
	padding: 10px;
	padding-left: 20px;
	padding-right: 20px;
}
#banner {
	background-image: url('bannerBG.png');
}
#assumptions {
	color: #ffffff;
	background-color: #14446c;
}
#luckLogo {
	height: 125px;
}
#incomeAccelLogo {
	height: 125px;
}
#invForm {
	padding: 30px;
}
th {
	color: #ffffff;
	background-color: #14446c;
}
img {
	margin: 15px;
}
.smallTxt {
	font-size: 12px;
}
</style>
	
<body>

<div id="banner" class="container-fluid">
	<div class="row">
		<div class="col-lg-8 text-left">
			<img id='incomeAccelLogo' src='incomeAccelLogo.png'/>
		</div>
		<div class="col-lg-4 text-right">
			<img id='luckLogo' src='luckLogo.png'/>
		</div>
	</div>
	<div class="row">
		<hr style='color: #185281; border-color: #185281; background-color: #185281; margin: 10px'/>	
	</div>
</div>

<div id="assumptions" class="container-fluid">
	
	<br/>
	
	<div class="container-fluid text-center">
		<form id='invForm'>
			<div class="row">
				<div class="col-lg-1"></div>
				<div class="col-lg-2">
					<p>Initial Investment<br/><br/><input id='initInvestInput' value='$100,000' required></input></p>
				</div>
				<div class="col-lg-2">
					<p>Initial Share Price<br/><br/><input id='initSharePriceInput' value='$100' required></input></p>
				</div>
				<div class="col-lg-2">
					<p>Dividend Yield<br/><br/><input id='divPercentInput' value='5%' required></input></p>
				</div>
				<div class="col-lg-2">
					<p>Dividend Growth Rate<br/><br/><input id='divGrowthPercentInput' value='5%' required></input></p>
				</div>
				<div class="col-lg-2">
					<p>Years Invested<br/><br/><input id='numYearsInput' value='5' required></input></p>
				</div>
				<div class="col-lg-1"></div>
			</div>
			<br/>
			<input type="submit" value="Submit" class='btn btn-default'></input>
		</form>
	</div>
</div>

<div id="scenarios" class="container-fluid"></div>

<div id="modalAdjustInv1" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
	    <div class="modal-body">
			<div id='adjustInv1'></div>
        </div>
    </div>
  </div>
</div>
<div id="modalAdjustInv2" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
	    <div class="modal-body">
			<div id='adjustInv2'></div>
        </div>
    </div>
  </div>
</div>
<div id="modalAdjustInv3" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
	    <div class="modal-body">
			<div id='adjustInv3'></div>
        </div>
    </div>
  </div>
</div>
<div id="modalAdjustInv4" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
	    <div class="modal-body">
			<div id='adjustInv4'></div>
        </div>
    </div>
  </div>
</div>
<div id="modalAdjustInv5" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
	    <div class="modal-body">
			<div id='adjustInv5'></div>
        </div>
    </div>
  </div>
</div>

<br/>

<div id="footer" class="container" style='width: 100%'>
	<p class="text-muted credit smallTxt">
		This <b><i>Income Accelerator</i></b> illustration is for discussion purposes only. 
		Information contained herein is obtained from sources believed to be reliable, but is not guaranteed. 
		Calculations/projections are based on a number of assumptions; actual results may differ.
		Yields/rates are as of the date of this report unless otherwise noted. 
		This report has been created by, and is the sole property and copyright of Darren Luck. 
		This report is provided exclusively for the clients of Darren Luck and the Luck Financial Group of CIBC Wood Gundy under licence. 
		The Income Accelerator report and its contents are the sole property of Darren Luck and the image or any likeness, in whole or in part may not be reproduced, disseminated, published or copied in any way.
		<br/>
		&copy; 2017 Darren Luck.
		<i>CIBC Wood Gundy is a division of CIBC World Markets Inc., a subsidiary of CIBC and a Member of the Canadian Investor Protection Fund and Investment Industry Regulatory Organization of Canada</i>.
	</p>
</div>


<script>

var inv1 = {};
var inv2 = {};
var inv3 = {};

var inv4 = {};
var chartInv4;
var chartInv4Income;

var inv5 = {};
var chartInv5;
var chartInv5Income;

var chartCompare;

$('#invForm').on('submit', function () {

	var initInvest = $('#initInvestInput').val().replace(/([$]|[,]|[ ])+/g, '');
	var initSharePrice = $('#initSharePriceInput').val().replace(/([$]|[,]|[ ])+/g, '');
	var divPercent = $('#divPercentInput').val().replace(/([%]|[,]|[ ])+/g, '');
	var divGrowthPercent = $('#divGrowthPercentInput').val().replace(/([%]|[,]|[ ])+/g, '');
	var numYears = $('#numYearsInput').val();
	
	var rex = /^[0-9]+([.][0-9]+){0,1}$/ig;
	if(!initInvest.match(rex)){
		alert('Invalid Input - Initial Investment');
		return false;
	}
	if(!initSharePrice.match(rex)){
		alert('Invalid Input - Share Price');
		return false;
	}
	if(!divPercent.match(rex)){
		alert('Invalid Input - Dividend Yield');
		return false;
	}
	if(!divGrowthPercent.match(rex)){
		alert('Invalid Input - Dividend Growth Rate');
		return false;
	}
	if(!numYears.match(/^[0-9]{1,2}$/ig)){
		alert('Invalid Input - Number of Years');
		return false;
	}
	
	inv1 = new Investment(1, initInvest, initSharePrice, divPercent, 0, numYears);
	inv1 = invCalc1(inv1);
	
	inv2 = new Investment(2, initInvest, initSharePrice, divPercent, 0, numYears);
	inv2 = invCalc2(inv2);
	
	inv3 = new Investment(3, initInvest, initSharePrice, divPercent, divGrowthPercent, numYears);
	inv3 = invCalc2(inv3);
	
	inv4 = new Investment(4, initInvest, initSharePrice, divPercent, divGrowthPercent, numYears);
	inv4 = invCalc2(inv4);
	
	inv5 = new Investment(5, initInvest, initSharePrice, divPercent, divGrowthPercent, numYears);
	inv5 = invCalc2(inv5);

	var scenariosHTML = "";
	
	scenariosHTML += "<br/>";
	
	scenariosHTML += "<ul class='nav nav-pills nav-justified'>";
	scenariosHTML += "<li onClick='detailedViewToggle();'><a>Detailed View</a></li>";
	scenariosHTML += "<li onClick='comparisonViewToggle();'><a>Comparison View</a></li>";
	scenariosHTML += "</ul>";
	
	// detailed view of scenarios
	
	scenariosHTML += "<div id='detailedScenarios'>";
	
	scenariosHTML += "<br/>";
	
	scenariosHTML += "<p class='row text-center'>";
	scenariosHTML += "Browse Scenarios  :";
	scenariosHTML += " <a href='#displayDetailedInv1'>1</a>";
	scenariosHTML += " <a href='#displayDetailedInv2'>2</a>";
	scenariosHTML += " <a href='#displayDetailedInv3'>3</a>";
	scenariosHTML += " <a href='#displayDetailedInv4'>4</a>";
	scenariosHTML += " <a href='#displayDetailedInv5'>5</a>";
	scenariosHTML += "</p>";
	
	scenariosHTML += "<div class='container-fluid'> <div id='displayDetailedInv1'></div> </div>";
	scenariosHTML += "<div class='container-fluid'>	<div id='displayDetailedInv2'></div> </div>";
	scenariosHTML += "<div class='container-fluid'> <div id='displayDetailedInv3'></div> </div>";
	
	scenariosHTML += "<div class='container-fluid'> <div id='displayDetailedInv4'></div> </div>";
	scenariosHTML += "<div class='container-fluid'> <div class='col-lg-6'> <canvas id='chartInv4'></canvas>  </div> <div class='col-lg-6'> <canvas id='chartInv4Income'></canvas> </div> </div>";
	
	scenariosHTML += "<div class='container-fluid'> <div id='displayDetailedInv5'></div> </div>";
	scenariosHTML += "<div class='container-fluid'> <div class='col-lg-6'> <canvas id='chartInv5'></canvas> </div> <div class='col-lg-6'>  <canvas id='chartInv5Income'></canvas> </div> </div>";
	
	scenariosHTML += "</div>";
	
	// non-detailed view of scenarios
	
	scenariosHTML += "<div id='nonDetailedScenarios'>";
	
	scenariosHTML += "<div id='displayInv1'></div>";
	scenariosHTML += "<div id='displayInv2'></div>";
	scenariosHTML += "<div id='displayInv3'></div>";
	scenariosHTML += "<div id='displayInv4'></div>";
	scenariosHTML += "<div id='displayInv5'></div>";
	
	scenariosHTML += "</div>";
	
	// comparison view of scenarios
	
	scenariosHTML += "<div id='comparisonScenarios'>";
	
	scenariosHTML += "<br/>";
	
	scenariosHTML += "<div class='row text-center'>";
	scenariosHTML += "<p>Please select two scenarios:</p>";
	scenariosHTML += "<div class='col-lg-6'> <select id='selectScenarioA' class='form-control' onchange='compareScenarioA()'> <option>1</option> <option>2</option> <option>3</option> <option>4</option> <option>5</option> </select> </div>";
	scenariosHTML += "<div class='col-lg-6'> <select id='selectScenarioB' class='form-control' onchange='compareScenarioB()'> <option>1</option> <option>2</option> <option>3</option> <option>4</option> <option>5</option> </select> </div>";
	scenariosHTML += "</div>";
	
	scenariosHTML += "<div class='row'>";
	scenariosHTML += "<div id='compareScenarioA' class='col-lg-6'> </div>";
	scenariosHTML += "<div id='compareScenarioB' class='col-lg-6'> </div>";
	scenariosHTML += "</div>";
	
	scenariosHTML += "<br/>";
	
	scenariosHTML += "<div class='row'>";
	scenariosHTML += "<div class='col-lg-2'> </div> <div class='col-lg-8'> <canvas id='chartCompare'></canvas> </div> <div class='col-lg-2'> </div>";
	scenariosHTML += "</div>";
	
	scenariosHTML += "</div>";
	
	$('#scenarios').html(scenariosHTML);
	
	$('#displayInv1').html(inv1.getHTML());
	$('#displayInv2').html(inv2.getHTML());
	$('#displayInv3').html(inv3.getHTML());
	$('#displayInv4').html(inv4.getHTML());
	$('#displayInv5').html(inv5.getHTML());
	
	$('#displayDetailedInv1').html(inv1.getDetailedHTML());
	$('#displayDetailedInv2').html(inv2.getDetailedHTML());
	$('#displayDetailedInv3').html(inv3.getDetailedHTML());
	$('#displayDetailedInv4').html(inv4.getDetailedHTML());
	$('#displayDetailedInv5').html(inv5.getDetailedHTML());
	
	$('#adjustInv1').html(getAdjustFormHTML(inv1));
	$('#adjustInv2').html(getAdjustFormHTML(inv2));
	$('#adjustInv3').html(getAdjustFormHTML(inv3));
	$('#adjustInv4').html(getAdjustFormHTML(inv4));
	$('#adjustInv5').html(getAdjustFormHTML(inv5));
	
	$('#nonDetailedScenarios').hide();
	$('#comparisonScenarios').hide();
	
	displayGraph();
	
    return false;
});

function getInv(invType){
	if(invType == 1){
		return inv1;
	} else if(invType == 2){
		return inv2;
	} else if(invType == 3){
		return inv3;
	} else if(invType == 4){
		return inv4;
	} else if(invType == 5){
		return inv5;
	} else {
		return null;
	}
}

function detailedViewToggle(){
	$('#detailedScenarios').show();
	$('#comparisonScenarios').hide();
}

function comparisonViewToggle(){
	$('#detailedScenarios').hide();
	$('#compareScenarioA').html($('#displayInv1').html());
	$('#compareScenarioB').html($('#displayInv2').html());
	$('#selectScenarioA').val(1);
	$('#selectScenarioB').val(2);
	displayGraphCompare(getInv(1), getInv(2));
	$('#comparisonScenarios').show();
}

function compareScenarioA(){
	$('#compareScenarioA').html(
		$('#displayInv' + document.getElementById("selectScenarioA").value).html()
	);
	displayGraphCompare(getInv(document.getElementById("selectScenarioA").value), getInv(document.getElementById("selectScenarioB").value));	
}

function compareScenarioB(){
	$('#compareScenarioB').html(
		$('#displayInv' + document.getElementById("selectScenarioB").value).html()
	);
	displayGraphCompare(getInv(document.getElementById("selectScenarioA").value), getInv(document.getElementById("selectScenarioB").value));	
}

function displayGraph(){

	var numYears = parseInt(inv1.numYears);

	var ctxInv4 = document.getElementById('chartInv4').getContext('2d');
	var ctxInv4Income = document.getElementById('chartInv4Income').getContext('2d');
	
	var ctxInv5 = document.getElementById('chartInv5').getContext('2d');
	var ctxInv5Income = document.getElementById('chartInv5Income').getContext('2d');
	
	if(chartInv4){
		chartInv4.destroy();
	}
	if(chartInv4Income){
		chartInv4Income.destroy();
	}
	
	if(chartInv5){
		chartInv5.destroy();
	}
	if(chartInv5Income){
		chartInv5Income.destroy();
	}
	
	// chart Inv 4
	chartInv4 = new Chart(ctxInv4, {
		type: 'line',
		data: {
			labels: range(1, 1 + numYears),
			datasets: [
			{
				label: 'Value',
				borderColor: 'rgb(0, 255, 0)',
				data: inv4.getChangeInInvs(),
				yAxisID: "y-axis-0",
				backgroundColor: 'rgba(0, 255, 0, 0.4)',
				fill: "1"
			},{
				label: 'Initial Value' ,
				borderColor: 'rgb(0, 0, 255)' ,
				data: fillList(inv4.initInvest, inv4.numYears),
				yAxisID: "y-axis-0",
				backgroundColor: 'rgba(0, 0, 255, 0.6)',
				fill: true
			}]
		},
		options: {
		    title: {
				display: true,
				text: 'Scenario 4 - Investment Over Time'
			},
			scales: {
				yAxes: 
				[
					{
						position: "left",
						"id": "y-axis-0",
						ticks:{
							min: 0,
							// https://stackoverflow.com/questions/28523394/charts-js-formatting-y-axis-with-both-currency-and-thousands-separator
							callback: function(value, index, values) {
							  if(parseInt(value) >= 1000){
								return '$' + value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
							  } else {
								return '$' + value;
							  }
							}
						},
					}
				]
			}
		}
	});
	
	// chart Inv 4 Income
	chartInv4Income = new Chart(ctxInv4Income, {
		type: 'bar',
		data: {
			labels: range(1, 1 + numYears),
			datasets: [{
				label: 'Income',
				borderColor: 'rgb(102, 217, 255)',
				data: inv4.dividends,
				yAxisID: "y-axis-1",
				backgroundColor: 'rgba(102, 217, 255, 0.6)',
			},{
				label: 'Cumulative Income',
				borderColor: 'rgb(0, 0, 128)',
				data: inv4.getTotalDividends(),
				yAxisID: "y-axis-1",
				backgroundColor: 'rgba(0, 0, 128, 0.6)',
			}]
		},
		options: {
			title: {
				display: true,
				text: 'Scenario 4 - Income Over Time'
			},
			scales: {
				xAxes: [{
						stacked: true,
					}
				],
				yAxes:
				[
					{
						position: "left",
						"id": "y-axis-1",
						ticks:{
							min: 0, 
							// https://stackoverflow.com/questions/28523394/charts-js-formatting-y-axis-with-both-currency-and-thousands-separator
							callback: function(value, index, values) {
							  if(parseInt(value) >= 1000){
								return '$' + value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
							  } else {
								return '$' + value;
							  }
							}
						},
					}
				]
			}
		}
	});
	
	
	// chart Inv 5
	chartInv5 = new Chart(ctxInv5, {
		type: 'line',
		data: {
			labels: range(1, 1 + numYears),
			datasets: [
			{
				label: 'Value',
				borderColor: 'rgb(0, 255, 0)',
				data: inv5.getChangeInInvs(),
				yAxisID: "y-axis-0",
				backgroundColor: 'rgba(0, 255, 0, 0.4)',
				fill: "1"
			},{
				label: 'Initial Value' ,
				borderColor: 'rgb(0, 0, 255)' ,
				data: fillList(inv5.initInvest, inv5.numYears),
				yAxisID: "y-axis-0",
				backgroundColor: 'rgba(0, 0, 255, 0.6)',
				fill: true
			}]
		},
		options: {
		    title: {
				display: true,
				text: 'Scenario 5 - Investment Over Time'
			},
			scales: {
				yAxes: 
				[
					{
						position: "left",
						"id": "y-axis-0",
						ticks:{
							min: 0,
							// https://stackoverflow.com/questions/28523394/charts-js-formatting-y-axis-with-both-currency-and-thousands-separator
							callback: function(value, index, values) {
							  if(parseInt(value) >= 1000){
								return '$' + value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
							  } else {
								return '$' + value;
							  }
							}
						},
					}
				]
			}
		}
	});
	
	// chart Inv 5 Income
	chartInv5Income = new Chart(ctxInv5Income, {
		type: 'bar',
		data: {
			labels: range(1, 1 + numYears),
			datasets: [{
				label: 'Income',
				borderColor: 'rgb(102, 217, 255)',
				data: inv5.dividends,
				yAxisID: "y-axis-1",
				backgroundColor: 'rgba(102, 217, 255, 0.6)',
			},{
				label: 'Cumulative Income',
				borderColor: 'rgb(0, 0, 128)',
				data: inv5.getTotalDividends(),
				yAxisID: "y-axis-1",
				backgroundColor: 'rgba(0, 0, 128, 0.6)',
			}]
		},
		options: {
			title: {
				display: true,
				text: 'Scenario 5 - Income Over Time'
			},
			scales: {
				xAxes: [{
						stacked: true,
					}
				],
				yAxes:
				[
					{
						position: "left",
						"id": "y-axis-1",
						ticks:{
							min: 0, 
							// https://stackoverflow.com/questions/28523394/charts-js-formatting-y-axis-with-both-currency-and-thousands-separator
							callback: function(value, index, values) {
							  if(parseInt(value) >= 1000){
								return '$' + value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
							  } else {
								return '$' + value;
							  }
							}
						},
					}
				]
			}
		}
	});
}

function displayGraphCompare(invFirst, invSecond){
	
	var numYears = parseInt(inv1.numYears);
	
	if(chartCompare){
		chartCompare.destroy();
	}
	
	var ctxCompare = document.getElementById('chartCompare').getContext('2d');
	
	// chart Compare
	chartCompare = new Chart(ctxCompare, {
		type: 'bar',
		data: {
			labels: range(1, 1 + numYears),
			datasets: [{
				type: 'line',
				label: 'Scenario ' + invFirst.invType + ' - Value',
				borderColor: 'rgb(255, 0, 0)',
				data: invFirst.getChangeInInvs(),
				yAxisID: "y-axis-0",
				backgroundColor: 'rgba(255, 0, 0, 0.6)',
				fill: false
			},{
				label: 'Scenario ' + invFirst.invType + ' - Additional Shares Purchased',
				borderColor: 'rgb(255, 0, 0)',
				data: invFirst.getAddedShares(),
				yAxisID: "y-axis-1",
				backgroundColor: 'rgba(255, 0, 0, 0.6)',
			},{
				type: 'line',
				label: 'Scenario ' + invSecond.invType + ' - Value',
				borderColor: 'rgb(0, 0, 255)',
				data: invSecond.getChangeInInvs(),
				yAxisID: "y-axis-0",
				backgroundColor: 'rgba(0, 0, 255, 0.6)',
				fill: false,
			},{
				label: 'Scenario ' + invSecond.invType + ' - Additional Shares Purchased',
				borderColor: 'rgb(0, 0, 255)',
				data: invSecond.getAddedShares(),
				yAxisID: "y-axis-1",
				backgroundColor: 'rgba(0, 0, 255, 0.6)',
			}]
		},
		options: {
			title: {
				display: true,
				text: 'Comparison of Scenarios'
			},
			scales: {
				xAxes: [{
						//stacked: true,
					}
				],
				yAxes:
				[
					{
						position: "left",
						"id": "y-axis-0",
						ticks:{
							min: 0, 
							// https://stackoverflow.com/questions/28523394/charts-js-formatting-y-axis-with-both-currency-and-thousands-separator
							callback: function(value, index, values) {
							  if(parseInt(value) >= 1000){
								return '$' + value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
							  } else {
								return '$' + value;
							  }
							}
						},
					},
					{	
						position: "right",
						"id": "y-axis-1",
						ticks:{
							min: 0, 
							//max: Math.pow(10, parseInt(Math.max(invFirst.getAddedShares()[numYears - 1], invSecond.getAddedShares()[numYears - 1])).toString().length)
							max: Math.round( ( Math.max( Math.max.apply(null, invFirst.getAddedShares()), Math.max.apply(null, invSecond.getAddedShares()) ) * Math.ceil( Math.max( invFirst.getChangeInInvs()[numYears - 1], invSecond.getChangeInInvs()[numYears - 1] ) / invFirst.initInvest ) ) / 10 ) * 10 
						},
					}
				]
			}
		}
	});
	
	
}

function adjustDisplayInv1() {
	inv1.divPercent = $('#divPercentInput1').val(); 

	inv1 = invCalc1(inv1);
	$('#displayInv1').html(inv1.getHTML());
	$('#displayDetailedInv1').html(inv1.getDetailedHTML());
	$('#modalAdjustInv1').modal('toggle');
	
	displayGraph();
	compareScenarioA();
	compareScenarioB();	
	return false;
}

function adjustDisplayInv2() {
	inv2.divPercent = $('#divPercentInput2').val(); 

	inv2 = invCalc2(inv2);
	$('#displayInv2').html(inv2.getHTML());
	$('#displayDetailedInv2').html(inv2.getDetailedHTML());
	$('#modalAdjustInv2').modal('toggle');
	
	displayGraph();
	compareScenarioA();
	compareScenarioB();	
	return false;
}

function adjustDisplayInv3() {
	inv3.divPercent = $('#divPercentInput3').val();
	inv3.divGrowthPercent = $('#divGrowthPercentInput3').val();

	inv3 = invCalc2(inv3);
	$('#displayInv3').html(inv3.getHTML());
	$('#displayDetailedInv3').html(inv3.getDetailedHTML());
	$('#modalAdjustInv3').modal('toggle');
	
	displayGraph();
	compareScenarioA();
	compareScenarioB();	
	return false;
}

function adjustDisplayInv4() {
	inv4.divPercent = $('#divPercentInput4').val();
	inv4.divGrowthPercent = $('#divGrowthPercentInput4').val();

	inv4 = invCalc2(inv4);
	$('#displayInv4').html(inv4.getHTML());
	$('#displayDetailedInv4').html(inv4.getDetailedHTML());
	$('#modalAdjustInv4').modal('toggle');
	
	displayGraph();
	compareScenarioA();
	compareScenarioB();	
	return false;
}

function adjustDisplayInv5() {
	inv5.divPercent = $('#divPercentInput5').val();
	inv5.divGrowthPercent = $('#divGrowthPercentInput5').val();

	inv5 = invCalc2(inv5);
	$('#displayInv5').html(inv5.getHTML());
	$('#displayDetailedInv5').html(inv5.getDetailedHTML());
	$('#modalAdjustInv5').modal('toggle');
	
	displayGraph();
	compareScenarioA();
	compareScenarioB();	
	return false;
}

function getAdjustFormHTML(inv){
	
	var html = "";
	
	var formID = 'adjustInvForm' + inv.invType;
	var formOnSubmit = 'return adjustDisplayInv' + inv.invType + '()';
	
	html += "<form id='" + formID + "' onsubmit='" + formOnSubmit + "'>";
		
	var divPercentID = 'divPercentInput' + inv.invType; 
	html += "<p>Dividend Percent (%) <input id='" + divPercentID + "' value='" + inv.divPercent + "'></input></p>";

	if(inv.invType == 3 || inv.invType == 4 || inv.invType == 5){
			
		var divGrowthPercentID = 'divGrowthPercentInput' + inv.invType;
		html += "<p>Dividend Growth Percent (%) <input id='" + divGrowthPercentID + "' value='" + inv.divGrowthPercent + "'></input></p>";
	}
	html += "<input type='submit' value='Submit Percentages'></input>";
	html += "</form>";
	
	return html;
}

function invCalc1(inv){

    inv.clearInvestVals();
    inv.clearDividends();
    inv.clearNumShares();
	
    var initInvest = inv.initInvest;
    var initSharePrice = inv.initSharePrice;
    var divPercent = inv.divPercent;
    var numYears = inv.numYears;
	
    var currInvest = 0;
	
	for(var i = 0 ; i < numYears ; i++){
	
		// number of shares = initial investment / initial share price
        inv.numShares.push(initInvest / initSharePrice);
        
		// current investment = current share price * current number of shares
        currInvest = inv.sharePrices[i] * inv.numShares[i];
        inv.investVals.push(currInvest);
        
		// dividend is a percentage of (initial share price * current number of shares)
        inv.dividends.push((initSharePrice * inv.numShares[i]) * (divPercent * 0.01));
    }

    return inv;
};

function invCalc2(inv){
    
    inv.clearInvestVals();
    inv.clearDividends();
    inv.clearNumShares();
    
	var initInvest = inv.initInvest;
    var initSharePrice = inv.initSharePrice;
    var divPercent = inv.divPercent;
    var divGrowthPercent = inv.divGrowthPercent;
	var numYears = inv.numYears;
        
    var currInvest = 0;
	
	for(var i = 0 ; i < numYears ; i++){
        
        if(i == 0){
            // number of shares = initial investment / initial share price
            inv.numShares.push(initInvest / initSharePrice);
        } else {
            // number of shares = previous number of shares + (previous dividend / current share price)
            inv.numShares.push(inv.numShares[i - 1] + (inv.dividends[i - 1] / inv.sharePrices[i]));
        }
		
        // current investment = current share price * current number of shares
        currInvest = inv.sharePrices[i] * inv.numShares[i];    
        inv.investVals.push(currInvest);
        
        if(i == 0){
            // dividend is a percentage of (initial share price * current number of shares)
            inv.dividends.push((initSharePrice * inv.numShares[i]) * (divPercent * 0.01));
        } else{
            // dividend is a percentage of (initial share price * current number of shares) + growth percentage
            inv.dividends.push(((initSharePrice * inv.numShares[i]) * (divPercent * 0.01)) * (1 + (divGrowthPercent * 0.01)));
		}
	}
	
    return inv;
}

function changeInitSharePrice(sharePrice, position, invType){
	
	if(invType == 4){
	
		inv4.initSharePrice = sharePrice;
		inv4.setSharePrice(sharePrice, position);
		
		inv4 = invCalc2(inv4);
		$('#displayInv4').html(inv4.getHTML());
		$('#displayDetailedInv4').html(inv4.getDetailedHTML());	
		displayGraph();
		compareScenarioA();
		compareScenarioB();	
	} else if(invType == 5){
	
		inv5.initSharePrice = sharePrice;
		inv5.setSharePrice(sharePrice, position);
		
		inv5 = invCalc2(inv5);
		$('#displayInv5').html(inv5.getHTML());
		$('#displayDetailedInv5').html(inv5.getDetailedHTML());	
		displayGraph();
		compareScenarioA();
		compareScenarioB();	
	}
}

function changeSharePrice(sharePrice, position, invType){
		
	if(invType == 4){
	
		inv4.setSharePrice(sharePrice, position);
		
		inv4 = invCalc2(inv4);
		$('#displayInv4').html(inv4.getHTML());
		$('#displayDetailedInv4').html(inv4.getDetailedHTML());
		displayGraph();
		compareScenarioA();
		compareScenarioB();
	} else if(invType == 5){
	
		inv5.setSharePrice(sharePrice, position);
		
		inv5 = invCalc2(inv5);
		$('#displayInv5').html(inv5.getHTML());
		$('#displayDetailedInv5').html(inv5.getDetailedHTML());
		displayGraph();
		compareScenarioA();
		compareScenarioB();
	}
}

function Investment(invType, initInvest, initSharePrice, divPercent, divGrowthPercent, numYears){
 
	this.invType = invType;
    this.initInvest = initInvest;
    this.initSharePrice = initSharePrice;
    this.divPercent = divPercent;
    this.divGrowthPercent = divGrowthPercent;
    this.numYears = numYears;
    this.sharePrices = fillList(initSharePrice, numYears);
    this.investVals = [];
    this.dividends = [];
    this.numShares = [];
	
	this.getAddedShares = function(){
		var addedShares = [];
		for(var i = 0 ; i < this.numYears ; i++){
			if(i == 0){
				addedShares.push(0);
			} else {
				addedShares.push(parseInt(this.numShares[i] - this.numShares[i - 1]));
			}
		}
		return addedShares;
	};
	this.getTotalAddedShares = function(){
		return this.numShares[numYears - 1] - this.numShares[0];
	};
	this.getTotalDividend = function(numYears){
		var totalDividend = 0;
		for(var i = 0 ; i < numYears ; i++){
			totalDividend += this.dividends[i];
		}
		return totalDividend;
	};
	this.getTotalDividends = function(){
		var totalDividends = [];
		for(var i = 0 ; i < this.numYears ; i++){
			totalDividends.push(this.getTotalDividend(i + 1));
		}
		return totalDividends;
	};
	this.getTotalDividendsPlusInitInvest = function(){
		var totalDividends = [];
		for(var i = 0 ; i < this.numYears ; i++){
			totalDividends.push(this.getTotalDividend(i + 1) + this.investVals[0]);
		}
		return totalDividends;
	};
	this.getTotalDividendsPlusInitInvestStartOfYear = function(){
		var totalDividends = [];
		for(var i = 0 ; i < this.numYears ; i++){
			if(i == 0){
				totalDividends.push(this.investVals[0]);
			} else {
				totalDividends.push(this.getTotalDividend(i + 1 - 1) + this.investVals[0]);
			}
		}
		return totalDividends;
	};
	this.getROI = function(){
		if(this.invType == 1){
			return ((this.investVals[numYears - 1] + this.getTotalDividend(this.numYears)) / this.investVals[0] - 1) * 100;
		} else {
			return ((this.investVals[numYears - 1] + this.dividends[numYears - 1]) / this.investVals[0] - 1) * 100;
		}
	};
	this.getAnnROI = function(){
		if(this.invType == 1){
			return (Math.pow((this.investVals[numYears - 1] + this.getTotalDividend(this.numYears)) / this.investVals[0], (1 / numYears)) - 1) * 100;
		} else {
			return (Math.pow((this.investVals[numYears - 1] + this.dividends[numYears - 1]) / this.investVals[0], (1 / numYears)) - 1) * 100;
		}
	};
	this.getChangeInInv = function(numYears){
		if(this.invType == 1){
			return this.investVals[numYears - 1] + this.getTotalDividend(numYears);
		} else {
			return this.investVals[numYears - 1] + this.dividends[numYears - 1];
		}
	};
	this.getChangeInInvs = function(){
		var changeInInvs = [];
		for(var i = 0 ; i < this.numYears ; i++){
			changeInInvs.push(this.getChangeInInv(i + 1));
		}
		return changeInInvs;
	};
	this.setSharePrice = function(sharePrice, position){
		this.sharePrices[position] = sharePrice;
	};
	this.clearInvestVals = function(){
		this.investVals = [];
	};
	this.clearDividends = function(){
		this.dividends = [];
	};
    this.clearNumShares = function(){
		this.numShares = [];
	};
	this.getTitle = function(){
		var title = "Scenario " + this.invType + " :<br/>";
		if(this.invType == 1){
			title += ". " + this.divPercent + "% Dividend (Cash Paid)<br/>. No Growth<br/>. No Volatility";
		} else if(this.invType == 2){
			title += ". " + this.divPercent + "% Dividend (Dividends Reinvested)<br/>. No Growth<br/>. No Volatility";
		} else if(this.invType == 3){
			title += ". " + this.divPercent + "% Dividend (Dividends Reinvested)<br/>. " + this.divGrowthPercent + "% Dividend Growth Rate<br/>. No Volatility";
		} else {
			title += ". " + this.divPercent + "% Dividend (Dividends Reinvested)<br/>. " + this.divGrowthPercent + "% Dividend Growth Rate<br/>. Share Price Volatility</li></ul>";
		}
		return title;
	};	
	this.getHTML = function(){
		var html = "";
		
		html += "<h2>" + this.getTitle() + "</h2>";
		html += "<button type='button' class='btn btn-default' data-toggle='modal' data-target='#modalAdjustInv" + this.invType + "'>Adjust Percentages</button> ";

		html += "<table class='table-striped'>";
		
		// Value == investVals
		// Income == Dividends
		// Cumulative Return == Total Dividends Received as of N Years
		
		html += "<tr>";
		html += "<th rowspan=2>Year</th> <th rowspan=2>Share Price</th> <th rowspan=2>Number of<br/>Shares</th> <th colspan=2>Account Value</th>";
		html += "</tr>";
		
		html += "<tr>";
		html += "<th>Start of Year</th> <th>End of Year</th>";
		html += "</tr>";
	
		for(var i = 0 ; i < this.numYears ; i++){
			
			html += "<tr>";
			html += "<td>" + (i + 1) + "</td>";
			
			if(i == 0 && (this.invType == 4 || this.invType == 5)){
				
				var changeInitSharePrice = 'changeInitSharePrice(this.value, ' + i + ',' + this.invType + ')';
				html += "<td>$<input onchange='" + changeInitSharePrice + "' value='" + numWithCommas(parseFloat(this.sharePrices[i]).toFixed(2)) + "' size=5></input></td>";
			} else if(this.invType == 4 || this.invType == 5){
				
				var changeSharePrice = 'changeSharePrice(this.value, ' + i + ',' + this.invType + ')';
				html += "<td>$<input onchange='" + changeSharePrice + "' value='" + numWithCommas(parseFloat(this.sharePrices[i]).toFixed(2)) + "' size=5></input></td>";
			} else {
				
				html += "<td>" + getCurrency(this.sharePrices[i])+ "</td>";
			}
			
			//html += "<td>" + getCurrency(this.sharePrices[i])+ "</td>";
			
			html += "<td>" + parseInt(this.numShares[i]) + "</td>";
			
			if(i > 0 && this.invType == 1){
			
				var yearStartAccountValue = this.investVals[i] + this.getTotalDividend(i);
				
				if(yearStartAccountValue < this.initInvest){
					html += "<td style='color: red'>";
				} else {
					html += "<td>";
				}
				
				html += getCurrency(yearStartAccountValue) + "</td>";
			} else {
				
				var yearStartAccountValue = this.investVals[i];
				
				if(yearStartAccountValue < this.initInvest){
					html += "<td style='color: red'>";
				} else {
					html += "<td>";
				}
				
				html += getCurrency(yearStartAccountValue) + "</td>";
			}
			
			var yearEndAccountValue = this.getChangeInInv(i + 1);
			
			if(yearEndAccountValue < this.initInvest){
				html += "<td style='color: red'>";
			} else {
				html += "<td>";
			}
			
			html += getCurrency(yearEndAccountValue) + "</td>";
			
			html += "</tr>";
		}
				
		html += "</table>";
					
		html += "<p>Net Total Return: <b>" + getPercentage(this.getROI()) + " ("+ getPercentage(this.getAnnROI()) + " Compound)</b></p>";
		
		html += "<p>Income Paid: <b>" + getCurrency(this.getTotalDividend(this.numYears)) + "</b></p>";
		
		var wealthCreated = this.getChangeInInv(this.numYears) - this.initInvest - this.getTotalDividend(this.numYears);
		if(-1 < wealthCreated && wealthCreated < 1) {
			html += "<p>Wealth Created: <b>" + getCurrency(0) + "</b></p>";
		} else {
			html += "<p>Wealth Created: <b>" + getCurrency(wealthCreated) + "</b></p>";
		}
		
		html += "<p>Net Profit: <b>" + getCurrency(this.getChangeInInv(this.numYears) - this.initInvest) + "</b></p>";
		
		return html;
	};
	this.getDetailedTitle = function(){
		var title = "Scenario " + this.invType + " : ";
		if(this.invType == 1){
			title += this.divPercent + "% Dividend (Cash Paid), No Growth, and No Volatility";
		} else if(this.invType == 2){
			title += this.divPercent + "% Dividend (Dividends Reinvested), No Growth, and No Volatility";
		} else if(this.invType == 3){
			title += this.divPercent + "% Dividend (Dividends Reinvested), " + this.divGrowthPercent + "% Dividend Growth Rate, and No Volatility";
		} else {
			title += this.divPercent + "% Dividend (Dividends Reinvested), " + this.divGrowthPercent + "% Dividend Growth Rate, and Share Price Volatility</li></ul>";
		}
		return title;
	};	
	this.getDetailedHTML = function(){
		var html = "";
		
		html += "<h2>" + this.getDetailedTitle() + "</h2>";
		html += "<button type='button' class='btn btn-default' data-toggle='modal' data-target='#modalAdjustInv" + this.invType + "'>Adjust Percentages</button> ";
		
		html += "<table class='table-striped'>";
		
		// Value == investVals
		// Income == Dividends
		// Cumulative Return == Total Dividends Received as of N Years
		
		html += "<tr>";
		html += "<th rowspan=2>Year</th> <th rowspan=2>Share Price</th> <th rowspan=2>Number of<br/>Shares</th> <th rowspan=2>Additional Shares<br/>Purchased</th> <th rowspan=2>Value</th>  <th rowspan=2>Yield *</th> <th rowspan=2>Income</th> <th rowspan=2>Cumulative<br/>Income</th> <th colspan=2>Account Value</th>";
		html += "</tr>";
		
		html += "<tr>";
		html += "<th>Start of Year</th> <th>End of Year</th>";
		html += "</tr>";
	
		for(var i = 0 ; i < this.numYears ; i++){
			
			html += "<tr>";
			html += "<td>" + (i + 1) + "</td>";
			
			if(i == 0 && (this.invType == 4 || this.invType == 5)){
				
				var changeInitSharePrice = 'changeInitSharePrice(this.value, ' + i + ',' + this.invType + ')';
				html += "<td>$<input onchange='" + changeInitSharePrice + "' value='" + numWithCommas(parseFloat(this.sharePrices[i]).toFixed(2)) + "' size=5></input></td>";
			} else if(this.invType == 4 || this.invType == 5){
				
				var changeSharePrice = 'changeSharePrice(this.value, ' + i + ',' + this.invType + ')';
				html += "<td>$<input onchange='" + changeSharePrice + "' value='" + numWithCommas(parseFloat(this.sharePrices[i]).toFixed(2)) + "' size=5></input></td>";
			} else {
				
				html += "<td>" + getCurrency(this.sharePrices[i])+ "</td>";
			}
			
			html += "<td>" + parseInt(this.numShares[i]) + "</td>";
			html += "<td style='background-color: #ffffb3'>" + parseInt(this.getAddedShares()[i]) + "</td>";
			
			var accountValue = this.investVals[i];
			
			if(accountValue < this.initInvest){
				html += "<td style='color: red'>";
			} else {
				html += "<td>";
			}
			html += getCurrency(accountValue) + "</td>";
			
			
			html += "<td>" + getPercentage((this.dividends[i] / this.investVals[0]) * 100) + "</td>";
			html += "<td style='background-color: #ffffb3'>" + getCurrency(this.dividends[i]) + "</td>";
			html += "<td>" + getCurrency(this.getTotalDividend((i + 1))) + "</td>";
			
			if(i > 0 && this.invType == 1){
			
				var yearStartAccountValue = this.investVals[i] + this.getTotalDividend(i);
				
				if(yearStartAccountValue < this.initInvest){
					html += "<td style='color: red'>";
				} else {
					html += "<td>";
				}
				
				html += getCurrency(yearStartAccountValue) + "</td>";
			} else {
				
				var yearStartAccountValue = this.investVals[i];
				
				if(yearStartAccountValue < this.initInvest){
					html += "<td style='color: red'>";
				} else {
					html += "<td>";
				}
				
				html += getCurrency(yearStartAccountValue) + "</td>";
			}
			
			var yearEndAccountValue = this.getChangeInInv(i + 1);
			
			if(yearEndAccountValue < this.initInvest){
				html += "<td style='color: red'>";
			} else {
				html += "<td>";
			}
			
			html += getCurrency(yearEndAccountValue) + "</td>";
			
			html += "</tr>";
		}
				
		html +=" <tr>";
		html += "<th style='background-color: #14446c' colspan=3></th>";
		html += "<th style='background-color: #14446c'>Total Shares<br/>Purchased</th>";
		html += "<th style='background-color: #14446c' colspan=2></th>";
		html += "<th style='background-color: #14446c'>Total Income Paid</th>";
		html += "<th style='background-color: #14446c' colspan=3></th>";
		html += "</tr>";
		
		html +="<tr>";
		html += "<td colspan=3></th>";
		html += "<td style='background-color: #ffffb3'><b>" + parseInt(this.getTotalAddedShares()) + "</b></td>";
		html += "<td colspan=2></td>";
		html += "<td style='background-color: #ffffb3'><b>" + getCurrency(this.getTotalDividend(this.numYears)) + "</b></td>";
		html += "<td colspan=3></td>";
		html += "</tr>";
		
		html += "</table>";
		
		html += "<p class='smallTxt'>* : Based on Initial Investment</p>";
					
		html += "<p>Net Total Return: <b>" + getPercentage(this.getROI()) + " ("+ getPercentage(this.getAnnROI()) + " Compound)</b></p>";
		
		html += "<p>Income Paid: <b>" + getCurrency(this.getTotalDividend(this.numYears)) + "</b></p>";
		
		var wealthCreated = this.getChangeInInv(this.numYears) - this.initInvest - this.getTotalDividend(this.numYears);
		if(-1 < wealthCreated && wealthCreated < 1) {
			html += "<p>Wealth Created: <b>" + getCurrency(0) + "</b></p>";
		} else {
			html += "<p>Wealth Created: <b>" + getCurrency(wealthCreated) + "</b></p>";
		}
		
		html += "<p>Net Profit: <b>" + getCurrency(this.getChangeInInv(this.numYears) - this.initInvest) + "</b></p>";
		
		//html += "<hr/>";
		
		return html;
	};
}

// currency formatting
function getCurrency(value){
	return "$" + numWithCommas(parseFloat(value).toFixed(2));
}

// percentage formatting
function getPercentage(value){
	return numWithCommas(parseFloat(value).toFixed(2)) + "%";
}

// https://stackoverflow.com/questions/12503146/create-an-array-with-same-element-repeated-multiple-times-in-javascript
function fillList(value, len) {
  var arr = [];
  for (var i = 0; i < len; i++) {
    arr.push(value);
  }
  return arr;
}

// https://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript
function numWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

// https://stackoverflow.com/questions/3746725/create-a-javascript-array-containing-1-n
function range(start, end) {
    var foo = [];
    for (var i = start; i < end; i++) {
        foo.push(i);
    }
    return foo;
}

// https://stackoverflow.com/questions/13911681/remove-html-tags-from-a-javascript-string
function removeTags(str){
	var rex = /(<([^>]+)>)/ig;
	return str.replace(rex, " ");
}
</script>

</body>
</html>